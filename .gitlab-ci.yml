image: openjdk:17

build:
  script:
    - ./gradlew build
  rules:
    - if: $CI_COMMIT_BRANCH == "l10n_master" || $CI_MERGE_REQUEST_SOURCE_BRANCH_NAME == "l10n_master"
      when: never
    - if: $CI_COMMIT_BRANCH =~ "l10n_master"
  artifacts:
    paths:
      - build/libs/*.jar
    expire_in: 1 month

deploy_all:
  script:
    - ./gradlew build
    - ./gradlew publishToModSites
  artifacts:
    paths:
      - build/libs/*.jar
    expire_in: 1 month
  when: manual

deploy_curseforge:
  script:
    - ./gradlew build
    - ./gradlew curseforge
  artifacts:
    paths:
      - build/libs/*.jar
    expire_in: 1 month
  when: manual

deploy_modrinth:
  script:
    - ./gradlew build
    - ./gradlew modrinth
  artifacts:
    paths:
      - build/libs/*.jar
    expire_in: 1 month
  when: manual
