plugins {
    id 'architectury-plugin' version '3.4-SNAPSHOT'
    id 'dev.architectury.loom' version '0.12.0-SNAPSHOT' apply false
    //id "io.github.pacifistmc.forgix" version "1.2.6"
}

architectury {
    minecraft = rootProject.mc_version
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'dev.architectury.loom'

    version = "${rootProject.versionId}"
    group = rootProject.group
    archivesBaseName = "${mod_name}-${mc_version}-${deploymentType}"

    JavaVersion targetVersion = JavaVersion.VERSION_17

    sourceCompatibility = targetVersion
    targetCompatibility = targetVersion

    loom {
        silentMojangMappingsLicense()
    }

    java {
        withSourcesJar()
    }

    dependencies {
        minecraft "com.mojang:minecraft:${project.mc_version}"
        mappings loom.officialMojangMappings()
    }

    tasks.withType(JavaCompile) {
        options.encoding = "UTF-8"

        // The Minecraft launcher currently installs Java 8 for users, so your mod probably wants to target Java 8 too
        // JDK 9 introduced a new way of specifying this that will make sure no newer classes or methods are used.
        // We'll use that if it's available, but otherwise we'll use the older option.
        if (targetVersion.isJava9Compatible()) {
            options.release = Integer.parseInt(targetVersion.getMajorVersion())
        }
    }
}

// def fileFormat = "${rootProject.mod_name}-${rootProject.mc_version}-${rootProject.deploymentType}-${rootProject.versionId}"

// forgix {
//     group = rootProject.group
//     mergedJarName = "${fileFormat}-universal.jar"
//     outputDir = "build/libs"

//    forge {
//        jarLocation = "build/libs/${fileFormat}-forge.jar"
//    }

//     fabric {
//         jarLocation = "build/libs/${fileFormat}-fabric.jar"
//     }
// }

allprojects {
    apply plugin: "architectury-plugin"
}